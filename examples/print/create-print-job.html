<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>Spark Sample Application - My Drive</title>

	<!-- Bootstrap core CSS -->
	<link href="../../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

	<!-- Custom styles -->
	<link href="../../assets/css/styleOld.css" rel="stylesheet">

	<script type="text/javascript" charset="utf-8" src="../../assets/scripts/config.js"></script>
	<script type="text/javascript" charset="utf-8" src="../../vendor/spark/spark-config.js"></script>
	<script type="text/javascript" charset="utf-8" src="../../vendor/spark/spark-auth.js"></script>

	<script type="text/javascript" charset="utf-8" src="../../vendor/jquery/jquery.min.js"></script>
	<script type="text/javascript" charset="utf-8" src="../../vendor/bootstrap/js/bootstrap.min.js"></script>
</head>

<body>

<div class="logged-in-container">
	<div class="container">

			<form id="print-job-form">
				<h1>Print Job</h1>
				<div class="form-group">
					<label for="fileURL">Printable File URL</label>
					<input type="text" class="form-control" id="fileURL" placeholder="File URL" required value="16818503">
				</div>
				<div class="form-group">
					<label for="printers-select">Printer name</label>

					<select class="form-control" id="printers-select" required>
					</select>
				</div>
				<div class="form-group">
					<label for="printer-settings">Settings</label>
					<textArea type="text" class="form-control" id="printer-settings" placeholder="">{ "FirstApproachRPM": 6, "FirstZLiftMicrons": 2000, "FirstSeparationMicronsPerSec": 5000, "FirstApproachMicronsPerSec": 5000, "FirstRotationMilliDegrees": 60000 }
					</textArea>
				</div>


				<input type="hidden" id="assetId">

				<div class="modal-footer">
					<input class="btn btn-primary" type="submit" value="Send" id="submit2">
					<a href="#" class="btn" data-dismiss="modal">Cancel</a>
					<input class="btn btn-primary" onclick="statePlugin.changeStateFromIframe('status','param=aa')" value="Next State">
				</div>
			</form>


			<div class="tab-pane fade" id="settings">
				<h2>Settings Content Goes Here</h2>
			</div>







		<div class="footer">
			<p>&copy; Spark Sample Application 2015</p>
		</div>

	</div></div>
<!-- /container -->

<script type="text/javascript" charset="utf-8" src="../../vendor/spark/utilities.js"></script>
<script type="text/javascript" charset="utf-8" src="../../vendor/spark/spark-printer.js"></script>

<script type="text/javascript" charset="utf-8" src="../../plugins/login/login.js"></script>
<script type="text/javascript" charset="utf-8" src="../../plugins/state/statePlugin.js"></script>
<script type="text/javascript" charset="utf-8" src="../../plugins/ajaxlogger/ajaxCallListener.js"></script>

<script>
	$(document).ready(function(){
		ajaxCallListenerFromIframe();
		//$(".footer").load("../../plugins/ajaxlogger/loggers.html");
	});


	var getAllPrinters = function(){
		sparkPrint.getAllPrinters(function(response){
			var printers = response.printers;
			$("#printers-select").find('option').remove()

			for(var i in printers){
				$("<option value='"+printers[i].printer_id+"'>"+printers[i].printer_id+":"+printers[i].printer_name+"</option>").appendTo("#printers-select")
			}
		});
	};


	getAllPrinters();

	$("#print-job-form").on('submit', function (e) {
		e.preventDefault();

		var fileUrl = $('#fileURL').val();
		var printerId = $('#printers-select').val();
		var settings = JSON.parse($('#printer-settings').val());

		sparkPrint.printJob(fileUrl,printerId,settings,function(response){
					var printerId = response.printer_id;
					//logger("#print-job-form #inputLog","Job sent successfully. "+JSON.stringify(response));
				},
				function(response){
					//logger("#print-job-form #inputLog","error:" + response);

				});
	});



</script>






</body>
</html>
