<!DOCTYPE html>
<html lang="en">
<head>
	<title>Spark Sample Application - Show My Assets - list view</title>
	<meta charset="utf-8">

	<!-- Bootstrap core CSS -->
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">

	<!-- Common styles -->
	<link href="../../assets/css/common.css" rel="stylesheet">


</head>

<body>

<div class="container">
	<div class="modal-header">
		<h4 class="modal-title" id="manageTitle">GET QUOTES</h4>
	</div>
</div>


<script type="text/javascript" charset="utf-8" src="//code.jquery.com/jquery-2.1.3.min.js"></script>
<script type="text/javascript" charset="utf-8"
        src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

<!-- spark sdk -->
<script type="text/javascript" charset="utf-8" src="//code.spark.autodesk.com/autodesk-spark-sdk.min.js"></script>

<!-- common scripts -->
<script type="text/javascript" charset="utf-8" src="../../assets/scripts/common.js"></script>

<!-- your config file and initialization -->
<script type="text/javascript" charset="utf-8" src="../../assets/scripts/config.js"></script>
<script type="text/javascript" charset="utf-8" src="../../assets/scripts/init.js"></script>

<!-- Enable broadcasting events and logging requests to top window -->
<script type="text/javascript" charset="utf-8" src="../../plugins/broadcaster/eventBroadcaster.js"></script>
<script type="text/javascript" charset="utf-8" src="../../plugins/ajaxlogger/ajaxCallListener.js"></script>

<script type="text/javascript" charset="utf-8" src="../../vendor/spark-js-sdk/sdk/src/service-bureaus/ServiceBureaus.js"></script>
<script>

	//log http requests
	ajaxCallListenerFromIframe();

	var currentFileId;

	var getSparkMaterials = function(){

		ADSKSpark.ServiceBureaus.getSparkMaterials().then(function (response) {
			console.info('upload file response:', response);
			if (response.length > 0) {

			}
		});

	}

	/**
	 * Run when DOM is ready.
	 * The spark object already exists in this point
	 */
	jQuery(function ($) {

		//First let's see if we have a valid access token
		if (!ADSKSpark.Client.isAccessTokenValid()) {
			location.href = '../../../plugins/login/login.html';
		} else {
			//Assume we provided assetId in URL
			var urlParams = ADSKSpark.Helpers.extractParamsFromURL();
			currentFileId = urlParams['fileId'] ? urlParams['fileId'] : 0;

			if (!currentFileId) {
				location.href = '../service-bureaus/upload.html';
			} else {

				common.setUIFunctionality();
				getSparkMaterials();
			}
		}

		//broadcast the state to the iframe - intended only for the storage UI
		eventBroadCaster.broadcastEvent('getQuotes',{fileId:currentFileId});
	});
</script>

</body>
</html>